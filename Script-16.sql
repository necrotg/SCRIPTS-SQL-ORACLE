CREATE TABLE GRAVADORA (
GRA_ID INTEGER NOT NULL,
GRA_NOME VARCHAR(100) NOT NULL,
GRA_CONTATO VARCHAR(11),
GRA_URL VARCHAR(50)
);

CREATE TABLE CD(
CD_ID INTEGER NOT NULL,
CD_NOME VARCHAR(100),
CD_PRECO NUMBER (5,2) NOT NULL,
CD_LANCAMENTO DATE,
CD_INDICADO INTEGER,
GRA_ID INTEGER NOT NULL
);

CREATE TABLE FAIXA(
MUS_ID INTEGER NOT NULL,
CD_ID INTEGER NOT NULL,
FAIXA_NUMERO INTEGER
);

CREATE TABLE MUSICA(
MUSICA_ID INTEGER NOT NULL,
MUSICA_NOME VARCHAR(100) NOT NULL,
MUSICA_DURACAO DECIMAL(6,2)
);

CREATE TABLE AUTOR(
AUT_ID INTEGER NOT NULL,
AUT_NOME VARCHAR(100) NOT NULL
);

CREATE TABLE MUS_AUTOR(
MUSICA_ID INTEGER NOT NULL,
AUT_ID INTEGER NOT NULL
);


ALTER TABLE GRAVADORA ADD CONSTRAINT FK_GRAVADORA PRIMARY KEY (GRA_ID);
ALTER TABLE CD ADD CONSTRAINT  FK_CD PRIMARY KEY (CD_ID);
ALTER TABLE MUSICA ADD CONSTRAINT FK_MUSICA PRIMARY KEY (MUSICA_ID);
ALTER TABLE AUTOR ADD CONSTRAINT FK_AUTOR PRIMARY KEY (AUT_ID);

ALTER TABLE CD ADD CONSTRAINT FK_CD_GRAVADORA FOREIGN KEY (GRA_ID) REFERENCES GRAVADORA (GRA_ID); 

ALTER TABLE MUS_AUTOR ADD CONSTRAINT FK_MUS_AUTOR
	FOREIGN KEY (MUSICA_ID)
	REFERENCES MUSICA (MUSICA_ID); 

ALTER TABLE MUS_AUTOR ADD CONSTRAINT FK_AUTOR_MUS
	FOREIGN KEY (AUT_ID)
	REFERENCES AUTOR (AUT_ID); 

ALTER TABLE FAIXA ADD CONSTRAINT FK_FAIXA_CD
	FOREIGN KEY (CD_ID)
	REFERENCES CD (CD_ID); 

ALTER TABLE FAIXA ADD CONSTRAINT FK_CD_FAIXA
	FOREIGN KEY (MUS_ID)
	REFERENCES MUSICA (MUSICA_ID); 

INSERT INTO GRAVADORA(GRA_ID, GRA_NOME, GRA_CONTATO, GRA_URL) VALUES
(1, 'GRAVADORA 1','1111111111','GRAVADORA1.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME,  GRA_CONTATO , GRA_URL) VALUES
(2, 'GRAVADORA 2','1111111112','GRAVADORA2.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME,  GRA_CONTATO, GRA_URL) VALUES
(3, 'GRAVADORA 3','1111111113','GRAVADORA3.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME, GRA_CONTATO, GRA_URL) VALUES
(4, 'GRAVADORA 4','1111111114','GRAVADORA4.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME,  GRA_CONTATO, GRA_URL) VALUES
(5, 'GRAVADORA 5','1111111115','GRAVADORA5.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME,  GRA_CONTATO, GRA_URL) VALUES
(6, 'GRAVADORA 6','1111111116','GRAVADORA6.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME,  GRA_CONTATO, GRA_URL) VALUES
(7, 'GRAVADORA 7','1111111117','GRAVADORA7.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME, GRA_CONTATO, GRA_URL) VALUES
(8, 'GRAVADORA 8','1111111118','GRAVADORA8.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME, GRA_CONTATO, GRA_URL) VALUES
(9, 'GRAVADORA 9','1111111119','GRAVADORA9.COM');
INSERT INTO GRAVADORA(GRA_ID, GRA_NOME, GRA_CONTATO, GRA_URL) VALUES
(10, 'GRAVADORA 10','1111111110','GRAVADORA10.COM');

INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(1, 'CD 1',100.21,TO_DATE( '01 Jan 2001', 'DD MON YYYY' ),1,1);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(2, 'CD 2',200.22,TO_DATE( '01 Jan 2002', 'DD MON YYYY' ),2,2);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(3, 'CD 3',300.23,TO_DATE( '01 Jan 2003', 'DD MON YYYY' ),3,3);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(4, 'CD 4',400.24,TO_DATE( '01 Jan 2004', 'DD MON YYYY' ),4,4);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(5, 'CD 5',500.25,TO_DATE( '01 Jan 2005', 'DD MON YYYY' ),5,5);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(6, 'CD 6',600.26,TO_DATE( '01 Jan 2006', 'DD MON YYYY' ),6,6);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(7, 'CD 7',700.27,TO_DATE( '01 Jan 2007', 'DD MON YYYY' ),7,7);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(8, 'CD 8',800.28,TO_DATE( '01 Jan 2008', 'DD MON YYYY' ),8,8);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(9, 'CD 9',900.29,TO_DATE( '01 Jan 2009', 'DD MON YYYY' ),9,9);
INSERT INTO CD(CD_ID, CD_NOME, CD_PRECO, CD_LANCAMENTO, CD_INDICADO, GRA_ID) VALUES
(10, 'CD 10',100.10,TO_DATE( '01 Jan 2010', 'DD MON YYYY' ),10,10);


INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(1, 'MUSICA 1',00002000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(2, 'MUSICA 2',00003000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(3, 'MUSICA 3',00004000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(4, 'MUSICA 4',00005000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(5, 'MUSICA 5',00002000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(6, 'MUSICA 6',00002000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(7, 'MUSICA 7',00003000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(8, 'MUSICA 8',00004000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(9, 'MUSICA 9',00005000);
INSERT INTO MUSICA(MUSICA_ID, MUSICA_NOME, MUSICA_DURACAO) VALUES
(10, 'MUSICA 10',00002000);


INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(1,'AUTOR 1');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(2,'AUTOR 2');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(3,'AUTOR 3');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(4,'AUTOR 4');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(5,'AUTOR 5');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(6,'AUTOR 6');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(7,'AUTOR 7');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(8,'AUTOR 8');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(9,'AUTOR 9');
INSERT INTO AUTOR(AUT_ID,AUT_NOME) VALUES
(10,'AUTOR 10');


INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(1,1);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(2,1);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(3,3);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(4,3);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(5,2);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(6,4);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(7,5);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(8,6);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(9,7);
INSERT INTO MUS_AUTOR(MUSICA_ID,AUT_ID) VALUES
(10,8);

INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(1,1,1);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(1,2,2);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(2,5,6);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(3,4,1);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(4,5,2);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(5,6,6);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(6,7,1);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(7,8,2);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(8,9,6);
INSERT INTO FAIXA(CD_ID, MUS_ID, FAIXA_NUMERO) VALUES
(9,10,6);

--3.A
SELECT * FROM GRAVADORA;
--3.B
SELECT CD_ID,CD_NOME,CD_PRECO FROM CD;
--3.C
SELECT AUT_ID,AUT_NOME FROM AUTOR ORDER BY AUT_NOME;
--3.D
SELECT AUT_ID,AUT_NOME FROM AUTOR ORDER BY AUT_NOME DESC; 
--3.E 
SELECT CD.CD_ID, CD_NOME FROM CD,GRAVADORA WHERE CD.GRA_ID = GRAVADORA.GRA_ID AND GRAVADORA.GRA_ID = 3;
--3.F
SELECT CD_NOME, CD_PRECO FROM CD,GRAVADORA WHERE CD.GRA_ID = GRAVADORA.GRA_ID AND GRAVADORA.GRA_ID = 3 AND CD_PRECO < 20;
--3.G
SELECT * FROM GRAVADORA WHERE GRA_CONTATO IS NULL; 
--3.H
SELECT * FROM GRAVADORA WHERE GRA_CONTATO IS NOT NULL ; 
--3.I
SELECT * FROM CD WHERE CD_PRECO > 200 AND CD_PRECO < 500;
--3.J
SELECT * FROM CD WHERE CD_LANCAMENTO > TO_DATE( '01 Jan 2000', 'DD MON YYYY' );
--3.K
SELECT * FROM MUSICA WHERE MUSICA_NOME LIKE 'M%';
--3.L
SELECT * FROM CD WHERE CD_NOME LIKE '_D%';
--3.M
SELECT * FROM CD WHERE CD_NOME LIKE '%2%';
--3.N
SELECT * FROM CD WHERE CD_PRECO < 500 ORDER BY CD_LANCAMENTO DESC; 
--3.O
SELECT * FROM MUSICA WHERE MUSICA_ID IN (1,3,5);



--4.A
SELECT CURRENT_DATE FROM DUAL;
--4.B
SELECT CD_NOME,CD_PRECO,CD_PRECO * 1.2 FROM CD c; 
--4.C
SELECT CD_NOME,CD_PRECO ,CD_PRECO * 1.2,(CD_PRECO * 1.2)- CD_PRECO  FROM CD c; 
--4.D
SELECT GRA_NOME|| '-' ||GRA_CONTATO FROM GRAVADORA;
--4.E
SELECT  * FROM AUTOR WHERE AUT_NOME LIKE '%T%';
--4.F
SELECT SUBSTR(MUSICA_NOME,1,1) , MUSICA_DURACAO FROM MUSICA;
--4.G 
SELECT CD_NOME, (CURRENT_DATE - CD_LANCAMENTO) FROM CD;
--4.H
SELECT CD_NOME, (CURRENT_DATE - CD_LANCAMENTO), CD_LANCAMENTO + 15 FROM CD;
--4.I
SELECT EXTRACT (YEAR FROM CD_LANCAMENTO) AS ANO_DE_LANÇAMENTO FROM CD WHERE CD_ID IN (1,2,3);
--4.j 
SELECT SUBSTR(MUSICA_NOME,1,5) FROM MUSICA;



-- 5.A
SELECT MIN (CD_PRECO), MAX (CD_PRECO) FROM CD;
-- 5.B
SELECT (MAX(CD_PRECO) - MIN(CD_PRECO)) FROM CD;
-- 5.C
SELECT (MAX (CD_LANCAMENTO) - MIN(CD_LANCAMENTO)) FROM CD;
--5.D 
SELECT SUM(MUSICA_DURACAO) FROM MUSICA, CD, FAIXA WHERE MUSICA.MUSICA_ID = FAIXA.MUS_ID AND FAIXA.CD_ID = CD.CD_ID AND CD.CD_ID = 1; 
--5.E
SELECT AVG(MUSICA_DURACAO) FROM MUSICA m WHERE MUSICA_NOME LIKE 'M%';
--5.F 
SELECT COUNT(CD_ID) FROM CD; 
--5.G
SELECT CD_NOME, AVG(MUSICA_DURACAO) FROM MUSICA, CD, FAIXA WHERE MUSICA.MUSICA_ID = FAIXA.MUS_ID AND FAIXA.CD_ID = CD.CD_ID GROUP BY CD.CD_NOME HAVING  AVG(MUSICA_DURACAO) <= 4000;
--5.H
SELECT AUT_NOME, COUNT(M.MUSICA_ID)  FROM AUTOR a, MUSICA m, MUS_AUTOR ma WHERE m.MUSICA_ID = ma.AUT_ID AND  A.AUT_ID = MA.AUT_ID GROUP BY AUT_NOME HAVING COUNT(M.MUSICA_ID)>1; 
